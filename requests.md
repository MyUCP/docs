# Запросы

- [Введение](#Введение)
- [Использование глобальных переменных](#Использование-глобальных-переменных)
- [Входные данные](#Входные-данные)
    - [GET](#GET)
    - [POST](#POST)
    - [COOKIE](#COOKIE)
    - [FILE](#FILE)

<a name="Введение"></a>
## Введение

Начиная с версии 5.4 вы можете использовать объект `Request` с новыми расширенными возможностями. Он по прежнему доступен в общем объекте данных `$this-&gt;request` но с прежним функционалом. Новые методы позволят вам работать с некоторыми данными более доступно и проще.

<a name="Использование-глобальных-переменных"></a>
## Использование глобальных переменных

Обычное использование глобальных переменных может быть небезопасно. Для того что бы убезопасить эти переменные от разных инъекций и т.д. вам необходимо использовать объект `request` и необходимо вам переменную из списка ниже.

### get[]
```php
$login = @$this->request->get['login']
```
### post[]
```php
$login = @$this->request->post['login']
```
### request[]
```php
$login = @$this->request->request['login']
```
### cookie[]
```php
$login = @$this->request->coockie['login']
```
### files[]
```php
$login = @$this->request->files['login']
```
### server[]
```php
$login = @$this->request->server['REMOTE_ADDR']
```

<a name="Входные-данные"></a>
## Входные данные

<a name="GET"></a>
### GET

Для получения GET данных вы можете использовать новый метод `get()` аргументом которой есть ключ данных, функция вернёт вам массив данных или значение. 

```php
<?php

class HomeController extends Controller
{
  //Получить значение login в адресе http://myucp/?login=elon
  public function index()
  {
    return Request::get('login'); //Будет выведено elon
  }
}
```

<a name="POST"></a>
### POST

Для получения POST данных вы можете использовать новый метод`post()` аргументом которой есть ключ данных, функция вернёт вам массив данных или значение. 

```php
<?php

class HomeController extends Controller
{
  //Получить значение login с формы
  public function index()
  {
    return Request::post('login'); //Будет выведено значение поля
  }
}
```

<a name="COOKIE"></a>
### COOKIE

Для получения COOKIE вы можете использовать метод `cookie()` аргументом которой выступает название куки, вторым аргументом функция принимает значение куки (будет перезаписано если кука уже существует), третьим аргументом принимает время жизни. В качестве результата вы получите объект `Cookie`, если вы указали второй аргумент то результатом будет результат установления значения куки. Как альтернативу вы можете использовать глобальную функцию `cookie()`.

```php
Request::cookie("token")->getValue(); //Вы получите значение куки token
Request::cookie("token", "elon", time() + 3600); //Куке token будет установлено значение elon с временем жизни час. 
```

Все куки которые устанавливает MyUCP устанавливаются в зашифрованном виде, тем самым обычное получение значения выведет вам результат в зашифрованном виде, если вы до этого установили куку вы можете получить её при помощи метода `unHashed()`.

```php
Request::cookie("token")->unHashed(); //Вы получите "чистую" куку
```

Если вам необходимо установить "вечную" куку то вы можете использовать метод `forever()`.

```php
Request::cookie("token", "elon")->forever(); //"На самом деле нет". Время жизни "вечной" куки - 5 лет.
```

<a name="FILE"></a>
### FILE

Для получения одного файла из массива принятых файлов `$_FILES` вы можете использовать метод `file()` аргументом которой выступает название поля. В качестве результата вы получите объект `File`. Вы можете получить разного рода информация о файле:

```php
Request::file("photo")->getExtension(); //Вы получите расширение файла
Request::file("photo")->getMd5(); //Вы получите md5-хэш файла
Request::file("photo")->getTmpPath(); //Вы получите полный путь к временному файлу на сервере
Request::file("photo")->getPath(); //Вы получите путь к временному файлу на сервере без указания самого файла в конце
Request::file("photo")->getError(); //Вы получите код ошибку
Request::file("photo")->getMimeType(); //Вы получите тип файла
Request::file("photo")->getSize(); //Вы получите размер файла
Request::file("photo")->getOriginalName(); //Вы получите оригинальное название файла
```

Вы так же можете сохранить загруженный файл при помощи метода `move()`, в качестве первого аргумента принимает путь куда будет помещён файл, если путь не указан файл будет помещён в директорию `assets/files`. В качестве второго аргумента принимает название файла под которым будет сохранен файл, если аргумент не указан название файла будет обернуто в `md5()` и сохранено с оригинальным расширением.

```php
Request::file("photo")->move(); //Файл будет перемещён в директорию "assets/files", название файла будет обернуто в "md5()"
Request::file("photo")->move("/assets/media/", "logo.png"); //Файл будет перемещён в директорию "assets/media", название файла будет "logo.png"
```