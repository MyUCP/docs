# Модели

- [Введение](#Введение)
- [Создание моделей](#Создание-моделей)
- [Подключение моделей](#Подключение-моделей)
- [Работа с данными](#Работа-с-данными)
    - [Таблица модели](#Таблица-модели)
    - [Первичный ключ](#Первичный-ключ)

<a name="Введение"></a>
## Введение

В структуре MVC модели служат для того что бы выполнять определенные операции и отдавать для контроллера результат. Вы можете создавать свои модели со своим набором функций.

<a name="Создание-моделей"></a>
## Создание моделей

Модель в **MyUCP** это класс который имеет набор список функций которые вы опишите и которые вы сможете использовать в контроллере.

Для создания модели необходимо создать файл в папке `/app/models/`. Название файла должно совпадать с названием вашей будущей модели. Для примера мы будем создавать модель под названием `Page`.

После создания файла в нем необходимо создать класс в котором будут наши функции:

```php
// app/models/Page.php

<?php

class Page extends Model 
{
    // Ваши методы
}
```

Как видим класс модели необходимо расширить основным классом `Model` что бы получить доступ до всех объектов.

После чего вы в классе сможете создавать нужные вам методы.

> Стоит учесть что в предыдущих версиях обязательно нужно было в конце дописывать к названию класса слово `Model`, в версии 5.7 это условие убрано и неявляется обязательным.

<a name="Подключение-моделей"></a>
## Подключение моделей

Для подключения нужной вам модели вы можете использовать метод в контроллере `model()` или используйте помощник `model()`, параметр функции принимает название модели. Так же вы можете указать сколько угодно параметров с названиями моделей, они все будут подключены постепенно.

```php
$this->controller->model('Page');
model('Page');
```

Результатом примера будет подключена модель `Page`, после подключения модели вы можете использовать все её функции, для того что бы использовать одну из функций модели нам необходимо обратиться к модели и вызвать нужную нам функцию.

Модель автоматически вносится в общий контейнер к которому вы можете обратится через функцию `app` или в контроллере просто используя обращение к контроллеру через `$this`

Пример:
```php
$page = $this->Page->getPage($id);
$page = app('Page')->getPage($id);
```

<a name="Работа-с-данными"></a>
## Работа с данными

В моделях вы можете использовать методы конструктора запросов, но указав некоторые данные вы сможете использовать
его в более упрощенном режиме.

> Обратите внимание, не смотря на то что в конструкторе запросов присутствует метод `insert()`, он не доступен при работе с моделями, его заменяет метод `create()`.

<a name="Таблица-модели"></a>
## Таблица модели

Каждая модель привязывается к своей таблице в базе данных что-бы работать с её данными. Изначально
название таблицы выбирается из названия класса модели и ставится во множество. Например у модели с названием
`Page`, название таблицы будет `pages`. Но если вы используете другое название то вы можете его заменить,
для этого просто нужно указать новое название в свойстве `$table` в вашей моделе:

```php
<?php

class Page extends Model 
{
    protected $table = "my_pages";
    
    //
}
```

Если вам нужно изменить название таблицы в процессе работы метода вам нужно обратиться к методу `table()` и передать в качестве аргумента
новое название таблицы.

> Если вы просто измените значение свойства, конструктор будет использовать старое название табилцы.

<a name="Первичный-ключ"></a>
## Первичный ключ

Метод для поиска записи `find()` и `first()` использует первичный ключ для поиска записи по `id`. Изначально первичный ключ указан как `id`, но так же
как в ситуации с таблицей вы можете изменить его указав в свойстве `$primary_key`.

```php
<?php

class Page extends Model 
{
    protected $primary_key = "page_id";
    
    //
}
``` 