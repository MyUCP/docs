# Маршрутизация

- [Введение](#Введение)
- [Правила маршрутизации](#Правила-маршрутизации)
- [Создание правила указывая тип](#Создание-правила-указывая-тип)
- [Дополнительные методы](#Дополнительные-методы)
- [Функция route()](#Функция-route)

<a name="Введение"></a>
## Введение

Начиная с версии **4.1.0** MyUCP использует систему маршрутизации, она заменяет обычную систему адресов, где часть адреса указывала на директорию и название файла контроллера. Теперь вы можете сами указывать контроллер и метод который должен обработать нужный вам шаг пользователя.
Все маршруты в MyUCP находяться в `app/routers.php`.

<a name="Правила маршрутизации"></a>
## Правила маршрутизации

В новой версии MyUCP было упрощенно создание правил маршрутизации, для этого были созданы новые методы: `any()`, `get()`, `post()`, `name()`, `uses()`.

При помощи метода `any()` вы можете создать правило которое не будет разделено на тип запроса **GET** или **POST**:

```php
Router::any("/", "HomeController@welcome"); // Вызовет метод welcome контроллера HomeController при переходе на главную страницу
```

<a name="Создание правила указывая тип"></a>
## Создание правила указывая тип

Вы можете разделить запросы которые будут приходить на ваш сайт на типы **GET** и **POST** тем самым это упростит работу например при использовании ajax, вам не нужно будет проводить лишние проверки на тип запроса.

Для создания нового правила в файле `routers.php` необходимо с новой строки прописать новый метод при помощи фасада `Router`:

```php
Router::get("/", "HomeController@welcome"); // Вызовет метод welcome контроллера HomeController при обычном GET запросе
Router::post("/", "HomeController@welcomePost");  // Вызовет метод welcomePost контроллера HomeController при обычном POST запросе
```

Как мы можем заметить метод `get()` как и метод `post()` принимают два параметра, первый параметр это сам URL, второй параметр вы можете указать как строку передав контроллер и метод которые вы хотите вызвать при переходе на данный адрес. 

Если указать второй параметр как массив то он должен иметь два значения: <em>as</em> и <em>uses</em>, первый из которых придаст имя маршруту, второй укажет какой метод вы хотите вызвать при переходе на указанный вами адрес в первом параметре.

```php
Router::get("/", ["as" => "home", "uses" => "HomeController@welcome"]);
```

<a name="Дополнительные методы"></a>
## Дополнительные методы

В примере выше было указано как вы можете указать сразу все необходимые параметры для правила маршрутизации, вы так же это можете сделать при помощи методов `name()` и `uses()`.

Метод `name()` укажет имя для выбранного вами правила маршрутизации при помощи которого в дальнейшем вы сможете обращаться к нему:

```php
Router::get("/", "HomeController@welcome")->name("home");
```

Метод `uses()` укажет контроллер и метод (разделенный знаком @) которые вы хотите вызвать при обращении по указанному вами адресу:

```php
Router::get("/")->uses("HomeController@welcome");
```

<hr>

> Начиная с версии <a href="https://github.com/maksa988/MyUCP/releases/tag/v5.3.1">5.3.1</a> указание правил маршрутизации было упрощенно при помощи методов `get()` и `post()`. **Старая система указания правил** (при помощи возвращаемого массива) **будет убрана** в следующей версии и считается устаревшей.

<hr>

<a name="Функция route()"></a>
## Функция route()

Данная функция будет полезна при составлении URL адресов на разные страницы и получение некоторых данных при разработке вашего проекта. Если не указать параметр `$name` в функцию, то она вернет значения текущего правила.

Функция возвращает массив данных состоящих из:

**name** - Название правила которое вы указали в файле `routers.php`, для получения значений другого правила, необходимо указать в качестве параметра название правила.
**rule** - Правило которые вы указывали в файле `routers.php` в ключе массив **url**.
**url** - URL на котором на данный момент находиться пользователь.
**controller** - Контроллер который указан в правиле, указан вместе с директориями
**method** - Метод который указан в правиле.
**parameters** - Массив параметров которые вы задали в правиле, если параметры не указаны значение будет пустым.

> Начиная с версии <a href="https://github.com/maksa988/MyUCP/releases/tag/v5.3.1">5.3.1</a> вы можете указать данную функцию в функцию помощник `redirect()` указав при этом название одного из правил маршрутизации, метод произведёт переадресацию на указанный вами маршрут.