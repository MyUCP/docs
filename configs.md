# Конфигурация

- [Вступление](#Вступление)
- [Конфигурация окружения](#Конфигурация-окружения)
    - [Базовые переменные системы](#Базовые-переменные-системы)
    - [Получение значений переменных](#Получение-значений-переменных)
- [Главный конфигурационный файл](#главный-конфигурационный-файл)
- [Подключение дополнительных конфигов](#подключение-дополнительных-конфигов)
- [Конфиг путей автозагрузки](#конфиг-путей-автозагрузки)
    - [Префиксы директорий](#Префиксы-директорий)

<a name="Вступление"></a>
## Вступление

Все файлы кофнигурации находятся в директории `configs`, изначально там указаны стандартные настройки, но вы можете изменить их под свои требования и задачи.

<a name="Конфигурация-окружения"></a>
## Конфигурация окружения

Для удобной настройки основных параметров работы приложения используется файл окружения `.env`

Для удобной работы с окружением используется библиотека [DotENV](https://github.com/vlucas/phpdotenv), которая адаптирована под работу в MyUCP.

Ваш файл конфигурации окружения `.env` не должен коммититься и отправлять в публичный доступ, так как может содержать важные данные для доступа, например к базе данных.

Если вы разрабатываете не один но вам нужно добавлять новые параметры для примера, вы можете добавлять их в `.env.example`.

> Для того что бы получить доступ к настройкам окружения создайте копию файла `.env.example` под новым названием `.env`

<a name="Базовые-переменные-системы"></a>
### Базовые переменные системы

В файле конфигурации уже существуют базовые переменные которые нужны для работы приложения.

`APP_NAME` - Название вашего приложения, которое вы можете использовать в шаблонах.

`APP_ENV` - Тип окружения которое используется для работы. (Может быть `local`, `production`, `dev` или любое другое указанное вами)

`APP_KEY` - ключ приложения, необходимый для безопасной работы некоторых модулей.

`APP_DEBUG` - режим откладки, если установлено значение `true` то будут вводится сообщения об ошибках и подробности, если `false` то будет просто показана страница ошибки из директории `resources/

> Важно не забыть на рабочем окружении выключить режим откладки.

`APP_URL` - адрес к вашему приложению, используется для генарции ссылок или переадрессации.

`APP_DB` - статус использования базы данных, если значение установлено `true` то буду использованы параметры ниже, если `false` то подключение не будет произведено.

`DB_DRIVER` - Драйвер для работы с базой данных.

`DB_CONNECTION` - Тип СУБД. В данный момент поддерживается только `MySQL`

`DB_HOST` - Хост базы данных.

`DB_DATABASE` - Название используемой базы данных.

`DB_USERNAME` - Имя пользователя базы данных.

`DB_PASSWORD` - Пароль пользователя базы данных.

`DB_CHARSET` - Кодировка подключения к базе данных.

<a name="Получение-значений-переменных"></a>
### Получение значений переменных

Все переменные при инициализации приложения помещаются в супер-глобальную переменную PHP.

Если обратить внимание на главный конфигурационный файл, там используется функция-помощник 'env()', которая дает возможность получить значение переменной из файла окружения.

```php
'debug_mode` => env('APP_DEBUG', true),
```

Вторым аргументом функции выступает базовое значение переменной если такое не указано.

<a name="главный-конфигурационный-файл"></a>
## Главный конфигурационный файл

Главный конфигурационный файл как и все остальные конфиги находятся в папке `configs` под названием `main.php`. В нем указаны все главные настройки для работы вашего приложения. Ниже описаны основные параметры которые изначально включены в него. Все комментарии параметров продублированы в самом конфиге.

Обращение к конфигурационному файлу происходит при помощи объекта `registry` или при помощи помощника `config()`, все эти два варианта вернут вам данные конфига и дополнительных конфигов в качестве объекта.

```php
// Режим откладки, рекомендуется использовать во время разработки
'debug_mode'	=>		env("APP_DEBUG", true),

// URL вашего сайта.
// Будет использовано при формировании URL адреса
'url'			=>		env("APP_URL", "http://localhost/"),

// Ключ приложения
// Будет использоват в шифровке данных
'app_key'		=>		env("APP_KEY", "empty"),

// Язык локализации который бдет использоватся на сайте
'locale'        =>      'ru',

// Резервный язык локализации
'fallback_locale'=>     'ru',

// Данные Базы Данных
'db'			=>		[
    // Драйвер для работы с БД.
    // По умолчанию MySQL (mysqli).
    'driver'		=>		env("DB_DRIVER", "driver"),

    // Тип СУБД.
    // По умолчанию поддерживается только СУБД MySQL (mysql).
    'type'			=>		env("DB_CONNECTION", "mysql"),

    // Хост БД.
    // Пример: localhost, 127.0.0.1, db.example.com и пр.
    'hostname'		=>		env("DB_HOST", "localhost"),

    // Имя пользователя СУБД.
    'username'		=>		env("DB_USERNAME", "root"),

    // Пароль пользователя СУБД.
    'password'		=>		env("DB_PASSWORD", "secret"),

    // Название БД.
    'database'		=>		env("DB_DATABASE", "myucp"),

    // Испльзуемая кодировка
    'charset'   	=> 		env("DB_CHARSET", "utf8"),
],

// Список пользовательских файлов для загрузки
'load_files'          =>      [
    //
],

// Список расширений
'extensions'   =>  [

    // Список расширений которые будут инициализированы при запуске приложения
    // Обязательно должны реализовывать класс BootExtensionable
    'boot'  =>  [
        //
    ],
],
```

В конфигурационном файле вы можете заметить пункт `load_files`, указав путь к любому своему файлу он будет подгружен при инициализации объекта главного конфига. Если вам нужно указать свои какие то "помощники" то можете создать файл с такими функциями и подгрузить их таким образом.

В конфигурационном файле вы можете так же заметить массив `extensions`  в котором указаны расширения и их алиасы. Подробнее можно прочитать в разделе <a href="/docs/5.7/extensions">Расширения</a> 

<a name="подключение-дополнительных-конфигов"></a>
## Подключение дополнительных конфигов

MyUCP умеет подгружать дополнительные конфигурационные файлы, для этого в директории `configs` вам необходимо создать свой файл, к примеру `rows` в котором например мы будем указывать названия полей для работы с некоторыми данными.

```php
- configs/
    - autload_classes.php
    - main.php
    - rows.php
```

К примеру наш конфиг имеет такое содержимое:

```php
<?php

return [
	"login"	=>	"user_login",
	// И другие параметры
];
```

После того как мы создадим файл он будет автоматически подгружен. Обратится к нему вы можете при помощи объекта `app('config')` или при помощи помощника `config()` в качестве аргумента мы можем передать название нашего файла, все методы обращения к конфигу можно увидить ниже:

```php
app('config')->row['login'];
config()->row->login;
config('row')->login;
```

<a name="конфиг-путей-автозагрузки"></a>
## Конфиг путей автозагрузки

Начиная с версии 5.4 теперь для подключение дополнительных классов или помощников, раньше это делалось по сути в "ядре" фреймворка, сейчас копия этого файла вынесена и теперь вы можете прописывать свои пути и они будут учитыватся.

Как и все конфиги он находится в директории `configs` под названием `autoload_classes.php`, по сути пути в нем указываются так же как и в обычном конфиге, в качестве массива.

> С версии **5.7** теперь вы можете использовать автозагрузку при помощи **PSR-4**, указав полный путь в пространстве имен. Без указания пути в конфиге.

<a name="префиксы директорий"></a>
### Префиксы директорий

Для автозагрузки по принципу **PSR-4** указаны стандартные префиксы для некоторых директорий:

`\App` - `app/`

`\MyUCP` - `engine/protected/`

`\Extensions` - `extensions/`