# Версии фреймворка

- [Политика поддержки старых версий](#Политика-поддержки-старых-версий)
- [MyUCP 5.7](#5.7)

<a name="Политика-поддержки-старых-версий"></a>
## Политика поддержки старых версий

Поддержка старых версий не производиться, а это значит что новая версия фреймворка есть самой актуальной и стоит использовать именно её. Если выходит более глобальное обновление то новая версия может содержать методы которые были в ней заменены / убраны но при этом использовались в предыдущей версии. Тем самым некоторые функции могут быть доступны ещё около 2-ух версий после обновления.

<a name="5.7"></a>
## MyUCP 5.7

### Шаблоны

Все шаблоны перемещены из директории `theme` в `resources/views`.

Шаблоны получили возможность предзагружать шаблоны, указывая название и путь к файлу шаблона.

У сервиса `ZaraService` добавилось пространство имён `App\services`.

Добавлен сервис `ViewService` для предзагрузки шаблонов или передачи общих данных в шаблоны.

Добавлена директива `@asset`, работает так же как и функция-помощник `asset()`.


### Контейнер

Был улучшен контейнер и добавлены новые методы для его работы, добавлена расширенная документация по работе с ним.

Вы можете генерировать пути к разным расположениям фреймворкам.

В некоторых класса (`Builder`, `Controller`...) были изменены классы для работы с контейнером с `Registry` (`$registry`) на `Application` (`$app`).

Если в контейнер нет класса он возвращает `false`.

### Автозагрузчик

Автозагрузчик теперь получил поддержку загрузки по `PSR-4`, теперь если вы используете пространства имён вам не нужно
прописывать классы и пути к ним в конфгируацинном файле.

### Отловщик ошибок

Был полностью переработан отловщик ошибок, все ошибки теперь отлавливаются и показываются в интерфейсе
дебагера который был раньше.

Окно ошибки так же было ушучлено, подкорректировано отображение участка кода, увеличено количество строк которые отображаются.
Добавлен стэк выполнения приложения до соверешения ошибки для анализа выполнения приложения.

Если дебаг-мод выключен то будет возвращаться не ошибка, а страница с 500 ошибкой которая теперь изначально находиться в директории ошибок шаблонов 
`resources/views/errors/500.php`.

Теперь в фреймворке вместо создания и вызова класса `Debug` используеться выбрасывание исключения при помощи класса `DebugException`, но вы можете создавать свои и все они так же будут отловлены.

### Сессия

Теперь метод `get()` и помощник `session` при передаче второго аргумента не изменяет значение ключа сессии, а устанавливает его как стандартное,
если данных по переданому ключу не было найдено.

Теперь метод `put()` может принимать в качестве значения функцию (объект `Closure`) и выполнит её для установления значения которое будет возвращенно в качестве результата.

### Расширения

На замену старой системе библиотек пришла новая система расширений, для неё был создан раздел документации с подробным описанием её работы и принципов.

В главном конфигурационном файле добавленны ключи `extensions` и `boot` для указания массива с расширениями.

### Модели

Теперь при создании модели не обязательно указывать ключевое слово `Model`, а так же называть файл отдельно. Теперь название модели и класса модели могут совпадать.
Старый вариант работы так же поддерживатеся согласно политике поддержки старых версий.

### Генератор ссылок

Генератор ссылок был улучшен, теперь помимо ссылки перед адресом он укзаывает домен приложения который указан в конфигурации.

Так же был добавлен метод для генерации ссылок к ваших файлам стиля или изображениям из директории `assets`.

Генерация так же была улучшена, и если у вас в конфигурации адрес приложения был указан с слэшем в конце конфликтов и двойных слэшей уже не будет.

Генератор ссылок получил новые методы `currentRoute()` и `current()` , которые возвращают текущий маршрут и текущий адрес по которому прошел запроса.

### Запросы

Были обновлены некоторые принципы работы запросов, так же была улучшена работа с файлами которые загружаются при помощи формы.

Добавлен метод `hasFile` для проверки передан ли был файл при отправке запроса. Вы можете передать массив для проверки существования несольких файлов.

Были добавлены два метода `::route()` и `getRoute()`, один статический, второй для вызова из объекта, они возвращают текущий маршрут по которому прошел запроса.

### Конфигурация

Добавлена поддержка файла окружения для более гибкой настройки вашего приложения на разных платформах и средах. Теперь для настройки приложения на разных платформах
не нужно ограничивать запись файла `configs/main.php`, все данные в него передаются из файла окружения.

### Маршрутизация

Добавлен сервис для преопределения маршрутов, находиться в директории с остальными сервисами и имеет название `RouteService`.

Метод `view()` при создании маршрута теперь принимает третьим параметром данные для передачи в шаблон.

Метод `redirect()` при создании маршрута третьим параметром принимает HTTP статус переадрессации, изначально установлен **302** статус.

Был добавлен новый метод для установления имени, старый метод `name()` остался, но новый метод полностью меняет название маршрута, а не дополнения того.

### Контроллер

В основном классе контроллера добавлены методы `view()`, `model()` работают по такому же принципу как и помощники с такими же названиями.

Контроллер получил новые методы для работы с загрузкой контроллеров, эти методы вызывают методы из нового класса `ControllerLoader`.