# Шаблоны

- [Введение](#Введение)
- [Подключение шаблонов](#Подключение-шаблонов)
- [Передача данных в шаблон](#Передача-данных-в-шаблон)
- [Предзагрузка шаблонов](#Предзагрузка-шаблонов)

<a name="Введение"></a>
## Введение

Views (представления, отображения, шаблоны) обычно содержат HTML-код вашего приложения и представляют собой удобный способ разделения бизнес-логики и логики отображения информации. Шаблоны хранятся в папке `resources/views`.

Простой шаблон выглядит примерно так:
```php
<!-- resources/views/greeting.php -->

<html>
    <body>
        <h1>Hello, <?php echo $name; ?></h1>
    </body>
</html>
```

<a name="Подключение-шаблонов"></a>
## Подключение шаблонов

После сохранения кода выше в файл `resources/views/greeting.php`, мы можем отобразить его, используя глобальную функцию-хелпер `view`:
```php
<?php

class HomeController extends Controller
{
    public function index()
    {
        return view('greeting', ['name' => "Elon"]);
    }
}
```
Как вы можете видеть, первый аргумент хелпера `view` - имя файла шаблона в папке `theme`, а второй - данные, которые будут в нем доступны. В данном примере, мы передаем переменную `name`, которая отображается через `echo`.

Конечно, шаблоны могут бы вложены в поддиректории внутри `resources/views`. Для обращения к таким шаблонам, вы можете указать путь отностиельно директории `resources/viws`. Например, если ваш шаблон находится в файле `resources/views/admin/profile.php`:
```php
return view('admin/profile', $data);
```

### Предзагрзузка шаблонов

Вы можете размещать шаблоны не только в директории `resources/view`, а в и в других местах, но что бы эти шаблоны
были найдены, необходимо указать пути к ним и их имена, то есть сделать "предзагрузку". Вы таким же способом можете в сервисе 
указать алиас для шаблона, например когда у вас шаблон называется `profile`, а вы хотите дать ему название `user`, то в конструктор сервиса просто добавьте:

```php
View::preLoad('user', app()->viewsPath('user.php'));
```

Как вы можете заметить, в данном случае уже нужно указывать полное название файла. Но если, например в <a href="/5.7/extensions">расширениях</a> указывать свои шаблоны,
и создать их в обычной директории `resources/views` под таким же названием, то они будут заменены вместо предзагруженных.

<a name="Передача-данных-в-шаблон"></a>
## Передача данных в шаблон

Как вы видели в предыдущем примере, вы можете просто передать массив с вашими данными в шаблон:
```php
return view('greetings', ['name' => 'Victoria']);
```
Когда вы передаете данные таким способом, `$data` должна являться массивом пар ключ-значение. Внутри представления вы можете обратиться к любому значению по соответствующему ему ключу, через `<?php echo $key; ?>`.

### Общие данные

Если вам во всех шаблонах нужно передать одни и те же данные, например это информация об авторизированном пользователе, то вы можете воспользоваться сервисом `ViewService`, в конструкторе
которого указать необходимые параметры для работы, например расшаривание данных:

```php
<?php
/**
 * MyUCP
 */

namespace App\services;

class ViewService
{
    public function __construct()
    {

         View::share(["user" => Auth::user()]);

    }

    public function render($viewName, $vars = [])
    {

        //

    }
}
```

Как вы можете заметить в сервисе доступно два метода, первый это конструктор, который будет вызван один раз при инициализации объекта шаблонов.

Второй метод это метод `render()` который будет вызыватся каждый раз при рендере шаблона, в качестве аргументов он принимате название шаблона и параметры которые были к нему переданы.

Вы можете использовать конструкцию `View::share()` и в других местах, но только использование сервиса обеспечивает точную доступность данных в других шаблонах.

<a name="Предзагрузка-шаблонов"></a>
## Предзагрузка шаблонов

Иногда вам может понадобиться загрузить шаблон из другой директории, но так как фреймворк видит шаблоны только из директории
`resources/views`, то для этого нужно использовать предзагрузку шаблонов.

Предзагрузка шаблонов помогает указать название шаблона и путь к нему, так же вы можете это использовать что бы указать более коротки путь к шаблону.

```php
View::preLoad('welcome', app()->assetPath('welcome.html'));
```

Теперь при вызове шаблона `welcome` он будет загружен из файла `assets/welcome.html`.

> Стоит учесть что если после предзагрузки шаблона предзагрузить еще один с таким же именем но с другим адресом, то старый вариант будет перезаписан.