# Шаблоны

- [Введение](#Введение)
- [Подключение шаблонов](#Подключение-шаблонов)
- [Передача данных в шаблон](#Передача-данных-в-шаблон)
- [Предзагрузка шаблонов](#Предзагрузка-шаблонов)

<a name="Введение"></a>
## Введение

Views (представления, отображения, шаблоны) обычно содержат HTML-код вашего приложения и представляют собой удобный способ разделения бизнес-логики и логики отображения информации. Шаблоны хранятся в папке `resources/views`.

Простой шаблон выглядит примерно так:
```php
<!-- resources/views/welcome.php -->

<html>
    <body>
        <h1>Hello, <?php echo $name; ?></h1>
    </body>
</html>
```

<a name="Подключение-шаблонов"></a>
## Подключение шаблонов

После сохранения кода выше в файл `resources/views/welcome.php`, мы можем отобразить его, используя глобальную функцию-хелпер `view`:
```php
Route::any('/', function() {
    return view('welcome', ['name' => 'Elon']); 
});
```
Как вы можете видеть, первый аргумент хелпера `view` - имя файла шаблона в папке `resources/views`, а второй - данные, которые будут в нем доступны. В данном примере, мы передаем переменную `name`, которая отображается через `echo`.

Конечно, шаблоны могут бы вложены в поддиректории внутри `resources/views`. Для обращения к таким шаблонам, вы можете указать путь отностиельно директории `resources/views`. Например, если ваш шаблон находится в файле `resources/views/admin/profile.php`:

```php
return view('admin.profile', $data);
return view('admin/profile', $data);
```

> Вы можете разделять директории при помощи точки, или при помощи обычных слэшей. Если вы будете использовать слэши для разделения директорий
то разделение точками будет игнорироваться

### Предзагрзузка шаблонов

Вы можете размещать шаблоны не только в директории `resources/views`, а в и в других местах, но что бы эти шаблоны
были найдены, необходимо указать пути к ним и их имена, то есть сделать "предзагрузку". Вы таким же способом можете в сервисе 
указать алиас для шаблона, например когда у вас шаблон называется `profile`, а вы хотите дать ему название `user`, то в конструктор сервиса просто добавьте:

```php
View::preload('user', app()->viewsPath('profile.php'));
```

Как вы можете заметить, в данном случае уже нужно указывать полное название файла. Но если, например в <a href="/5.8/extensions">расширениях</a> указывать свои шаблоны,
и создать их в обычной директории `resources/views` под таким же названием, то они будут заменены вместо предзагруженных.

<a name="Передача-данных-в-шаблон"></a>
## Передача данных в шаблон

Как вы видели в предыдущем примере, вы можете просто передать массив с вашими данными в шаблон:

```php
view('welcome', ['name' => 'Victoria']);
```

Вторым аргументом вам нужно передавать массив данных, ключи которых будут преобразованы в названия переменных.

Вы так же можете использовать метод `with` который позволит вам "дособрать" шаблон с данными для дальнейшего использования.

```php
view('welcome')->with('name', 'Victoria)
                ->with('surname', 'Jay');
```

Вы так можете передать одно значение в виде массива, которое будет равно первому варианту:

```php
view('welcome')->with(['name' => 'Victoria']);
```

### Общие данные

Если вам во всех шаблонах нужно передать одни и те же данные, например это информация об авторизированном пользователе, вы можете воспользоваться сервисом `ViewService`, в конструкторе
которого указать необходимые параметры для работы, например расшаривание данных:

```php
<?php

namespace App\Services;

use MyUCP\Views\View;
use MyUCP\Views\Interfaces\ViewService as ServiceContact;

class ViewService implements ServiceContact
{

    /**
     * ViewService constructor.
     */
    public function __construct()
    {
        View::share('user', Auth::user());
    }

    /**
     * @param string $view
     * @param array $data
     * @return mixed
     */
    public function render($view, array $data = [])
    {
        //
    }
}
```

Как вы можете заметить в сервисе доступно два метода, первый это конструктор, который будет вызван один раз при инициализации объекта шаблонов.

Второй метод это метод `render()` который будет вызыватся каждый раз при рендере шаблона, в качестве аргументов он принимате название шаблона и параметры которые были к нему переданы.

Метод `share` является статическим и принимает два параметра, первый это ключ, второй это значение переменной. Если вы передадите в качестве первого параметра массив данных
то он будет преобразован в массив данных вида ключ - значение.

```php
View::share(['user' => Auth::user()]);
```

Вы можете использовать конструкцию `View::share()` и в других местах, но только использование сервиса обеспечивает точную доступность данных в других шаблонах.

<a name="Предзагрузка-шаблонов"></a>
## Предзагрузка шаблонов

Иногда вам может понадобиться загрузить шаблон из другой директории, но так как фреймворк видит шаблоны только из директории
`resources/views`, то для этого нужно использовать предзагрузку шаблонов.

Предзагрузка шаблонов помогает указать название шаблона и путь к нему, так же вы можете это использовать что бы указать более коротки путь к шаблону.

```php
View::preLoad('welcome', app()->assetPath('welcome.html'));
```

Теперь при вызове шаблона `welcome` он будет загружен из файла `assets/welcome.html`.

Вы таким же способом можете в сервисе 
указать алиас для шаблона, например когда у вас шаблон называется `profile`, а вы хотите дать ему название `user`, то в конструктор сервиса просто добавьте:

```php
View::preload('user', app()->viewsPath('profile.php'));
```

Как вы можете заметить, в данном случае уже нужно указывать полное название файла. Но если, например в <a href="/5.8/extensions">расширениях</a> указывать свои шаблоны,
и создать их в обычной директории `resources/views` под таким же названием, то они будут заменены вместо предзагруженных.
