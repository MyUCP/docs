# Сессии

- [Введение](#Введение)
- [Использование сессий](#Использование-сессий)
    - [Одноразовые flash-данные](#Одноразовые-flash-данные)

<a name="Введение"></a>
## Введение

Протокол HTTP не имеет средств для фиксации своего состояния. Сессии - способ сохранения информации (например, ID залогиненного пользователя) между отдельными HTTP-запросами. MyUCP поставляется со множеством различных механизмов сессий, доступных через единое API. Фактически, сессия - это хранилище данных типа ключ-значение.

<a name="Использование сессий"></a>
## Использование сессий

#### Получение данных из сессии

К данным сессии можно получить доступ через экземпляр класса `Session`, который вы можете использовать через функцию-помощник `session()` или через глобальный объект `Registry`:

```php
<?php

class UserController extends Controller
{
	public function showProfile($id)
	{
		$this->session->data['user_id'];
		$this->session->get('user_id');

		session("user_id");
	}
}
```

Вторым аргументом вы можете указать новое значение которое будет установленно для данного ключа:

```php
$this->session->get('user_id', '1');

$this->session->get('user_id', function() {
	return 1;
});
```

Так можно получить все данные, которые хранятся в сессии:

```php
$this->session->all();
```

#### Проверка на существование ключа

Можно проверить, хранится ли в сессии заданный ключ (метод возвратит true, если данные с таким ключом есть):

```php
if($this->session->has('users')) {
    //
}
```

#### Сохранение данных в сессии

```php
$this->session->put('key', 'value');
```

#### Удаление данных из сессии

```php
$this->session->forget('key');
```

<a name="Одноразовые flash-данные"></a>
### Одноразовые flash-данные

Иногда вам нужно сохранить переменную только для следующего запроса, после выполнения которого она должна быть автоматически удалена. Это нужно, например, для передачи ошибок валидации в форму - при сабмите формы выполняется POST-запрос, после которого обязательно должен идти редирект, и для сохранения текста ошибки используют сессии. Вы можете сделать это методом `flash()`:

```php
$this->session->flash('status', 'Task was successful!');
```

Если вам понадобилось передать flash-данные дальше, вы можете сохранить их все для следующего запроса:

```php
$this->session->reflash();
```