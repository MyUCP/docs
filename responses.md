# Ответ (Response)

- [Создание ответа](#Создание-ответа)
- [Дополнение ответа](#Дополнение-ответа)
    - [Добавление заголовков](#Добавление-заголовков)
	- [Добавление Cookies](#Добавление-cookie)
	- [Кодировка](#Кодировка)
- [Переадрессация](#Переадрессация)
    - [Переадрессация на маршруты](#Переадрессация-на-маршруты)
	- [Переадрессация на контроллер](#Переадрессация-на-контроллер)
	- [Переадрессация на внешние ресурсы](#Переадрессация-на-внешние-ресурсы)
	- [Flash-данные в сессии](#Flash-данные-в-сессии)
	- [Обновление страницы](#Обновление-страницы)
- [Страница не найдена](#Страница-не-найдена)
	
<a name="Создание-ответа"></a>
## Создание ответа

HTTP-Response - это ответ фреймворка, который отдается клиенту (обычно это браузер), от которого пришел HTTP-запрос.

Наиболее простой способ создать HTTP-ответ - это возвратить строку в маршруте или контроллере.

#### Строки и массивы

Вы можете отправлять в ответ строки или масиивы. Строки будут выведены клиенту просто как ответ,
а в случае с массивами они будут преобразованы в JSON для того что бы удобно те клиенту. То есть
вам теперь нет необходимости самому преобразовывать данные в JSON когда это нужно, вы можете просто вернуть
массив данных.

```php
Router::get('/', function () {
    return 'Hello World';
});

Route::get('/', function () {
    return [1, 2, 3];
});
```

<a name="Дополнение-ответа"></a>
## Дополнение ответа

В последней версии `Response` это класс который отвечает за ответ клиенту от вашего приложения.
Он имеет ряд методов которые доступны теперь в приложении и с помощью которых вы можете изменять ответ который
вы хотите вернуть клиенту.

```php
Route::get('home', function () {
    return response()->setStatusCode(200)
		     ->setContent("Hello World")
		     ->header('Content-Type', 'text/plain');
});
```

<a name="Добавление-заголовков"></a>
### Добавление заголовков

В любой момент вы можете добавить нужные вам заголовки к вашему ответу, тоесть подготовить его.
Для этого вы можете использовать метод `header($key, $value)`. Или вы можете добавить сразу несколько
заголовков одним методом, передав в него массив:

```php
return response()
            ->header('Content-Type', $type)
            ->header('X-Header-One', 'Header Value')
            ->header('X-Header-Two', 'Header Value');

//
return response()
		->withHeaders([
			'Content-Type' => $type,
			'X-Header-One' => 'Header Value',
			'X-Header-Two' => 'Header Value',
		]);

```

<a name="Добавление-cookie"></a>
### Добавление Cookies

Отправка кук теперь стала проще, вы можете их добавить к ответу непосредственно во время ответа,
или ранее, так же используя объект `Response`.

```php
response()->cookie('name', 'value', $minutes);
response()->withCookie('name', 'value', $minutes);
```

<a name="Кодировка"></a>
### Кодировка

Вы можете изменить кодирку с которой будет отправлен ответ при помощи метода `setCharset($charset)`.

```php
response()->setCharset("UTF-8");
```

<a name="Переадрессация"></a>
## Переадрессация

Переадрессация - это экземпляр класса `Redirect`, вызывается при помощи функции-помощника `redirect()`.

Этот класс полностью совместим с классом ответа, и его объект будет обработан как указание на переадрессацию с нужными инструкциями.
В предыдущих версиях переадрессация происходила сразу же после выполнения функции или инициализации объекта `Redirect`.
Сейчас же для осуществления переадрессации вам необходимо вернуть в качестве ответа объект `Response`.

```php
Route::get('dashboard', function () {
    return redirect('home/dashboard');
});
```

<a name="Переадрессация-на-маршруты"></a>
### Переадрессация на маршруты

Вы можете совершить переадрессацию сразу на нужный вам маршрут, для этого достаточно передать имя маршрута
или его объект. 
```php
return redirect('login');
return redirect(route('login')); // Аналогично строке выше
return redirect()->route('login'); // Тоже самое что и выше
```

Но если ваш маршрут имеет параметры, вы можете просто вторым аргументом указать их в качестве массива:

```php
return redirect('profile', ["id" => 1]);
```

<a name="Переадрессация-на-контроллер"></a>
### Переадрессация на контроллер

Если вы хотите совершить переадрессацию на какой то контроллер и его метод, но у такого маршрута нет имени,
вы можете просто указать название контроллера и метода как вы это делаете при создании маршрута.

```php
return redirect()->action('HomeController@index');
```

В случае если у этого маршрута есть параметры, то вы так же можете их указать в качестве массива:

```php
return redirect()->action('UserController@profile', ['id' => 1]);
```

<a name="Переадрессация-на-внешние-ресурсы"></a>
### Переадрессация на внешние ресурсы

Иногда вам нужно сделать переадрессацию на другой сайт или ресурс, для этого вы можете использовать метод
`away` когда создаете переадрессацию:

```php
return redirect()->away('https://spacex.com');
```

<a name="Flash-данные-в-сессии"></a>
### Flash-данные в сессии

Редирект с <a href="/docs/5.7/session">flash-данными в сессии</a> - типичная задача в случае, когда после POST-запроса надо перейти на страницу с формой и показать ошибки валидации. Записать flash-данные в сессию можно при помощи метода `with()`:

```php
return redirect('user/login')->with('message', 'Login Failed');
```

<a name="Обновление-страницы"></a>
### Обновление страницы

Иногда после совершения неких действий пользователем (например отправлением `POST` запроса, вам необходимо предотвратить повторное отправление формы, вы можете использовать ещё один хэлпер который работает на основе `redirect()` и производит обновление страницы:

```php
return refresh();
```

<a name="Страница-не-найдена"></a>
## Страница не найдена

Если в момент работы приложения, в каком-то участке кода вам нужно указать что страница по этому адерсу не найдена, то есть выбросить ошибку 404,
вы можете использовать метод `notFound()`.

```php
if(...) {
    return resposne()->notFound();
}
```